{{ define "config" }}
{{ template "header" . }}

<body class="w3-light-grey">
  {{ template "side" . }}
  <!-- !PAGE CONTENT! -->
  <div class="w3-main" style="margin-left:300px;margin-top:43px;">

    <!-- Header -->
    <header class="w3-container" style="padding-top:22px">
      <h5><b><i class="fa fa-dashboard"></i> Edit</b></h5>
    </header>

    <div class="w3-row-padding w3-margin-bottom">
      <form id="set">
        <p>
          <label>Server address</label>
          <input class="w3-input" type="text" name="serverAddress" id="sa"></p>
        <p>
          <label>Server port</label>
          <input class="w3-input" type="number" name="serverPort" id="sp"></p>
        <p>
          <label>Threshold</label>
          <i> eg [80,70]</i>
          <input class="w3-input" type="text" name="threshold" id="th"></p>
          <p>
              <label>Min count</label>
              <input class="w3-input" type="number" name="minCount" id="min"></p>
           
            <p>
                <label>Rotate for motion</label>
                <input class="w3-input" type="number" name="rotate" id="rot"></p>
              <button class="w3-button w3-green" type="submit">Save</button>
      </form>
    </div>


    <script>
      temp = ""
      function getSer() {
        var jsonT;
        var xhttp = new XMLHttpRequest();
        xhttp.withCredentials = true;
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            jsont = JSON.parse(this.responseText)
            console.log(jsont)
            $("#sa").val(jsont["serverAddress"])
            $("#sp").val(jsont["serverPort"])
            $("#th").val(jsont["threshold"])
            $("#min").val(jsont["minCount"])

          }
        };
        xhttp.open("GET", "http://localhost:8000/s/config/config:motion", true);
        xhttp.send();

      }

      getSer()

      $("#set").on("submit", function () {
        event.preventDefault();
        var dataJson = JSON.stringify({
          "serverAddress": $("#sa").val(), "serverPort": $("#sp").val(),
          "threshold": $("#th").val(), "minCount": $("#min").val()
        })
        var xhttp = new XMLHttpRequest();
        xhttp.withCredentials = true;
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {

          }
        };
        xhttp.open("POST", "http://localhost:8000/s/config/config:motion", true);
      xhttp.send(dataJson);
      
      });
     

    </script>
    {{ template "footer" . }}

    <!-- End page content -->
  </div>


</body>

</html>
{{ end }}